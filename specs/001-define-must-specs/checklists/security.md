# Security Checklist: MUST Inference Platform Baseline

**Purpose**: Validate security requirements quality, completeness, and release-gate readiness before implementation.
**Created**: 2026-02-26
**Feature**: [spec.md](../spec.md)

**Note**: This checklist is generated by the `/speckit.checklist` command based on feature context and requirements.

## Requirement Completeness

- [x] CHK001 Are authentication requirements specified for every protected endpoint class (generation, media, admin) with explicit precedence? [Completeness, Spec §FR-001, Spec §Security & Secrets Impact]
- [x] CHK002 Are secret lifecycle requirements (issuance, rotation, revocation, compromise response) explicitly documented? [Gap, Spec §Security & Secrets Impact]
- [x] CHK003 Are requirements defined for protecting third-party worker credentials at rest and in transit, not only "no plaintext in repo"? [Completeness, Gap, Spec §Security & Secrets Impact, Spec §FR-011]

## Requirement Clarity

- [x] CHK004 Is the auth precedence (`X-API-Key` → `api_key` → `gg_session`) unambiguous for all request surfaces, including browser media fetches? [Clarity, Spec §Clarifications, Spec §FR-001]
- [x] CHK005 Is "approved frontend origins" quantified as a controlled allowlist definition instead of a generic phrase? [Ambiguity, Spec §Security & Secrets Impact]
- [x] CHK006 Is "secure secret management" translated into explicit storage boundaries and prohibited locations? [Clarity, Spec §Security & Secrets Impact]

## Requirement Consistency

- [x] CHK007 Do authentication requirements in Functional Requirements align with API Contract rows for `/auth/session`, `/results/{task_id}`, and `/preview/{task_id}`? [Consistency, Spec §FR-001, Spec §API Contract & Compatibility]
- [x] CHK008 Are admin authentication constraints consistent with audit requirements for both successful and failed privileged actions? [Consistency, Spec §Security & Secrets Impact, Spec §FR-012, Spec §Observability & Operations]
- [x] CHK009 Are duplicate requirement IDs and duplicated entity definitions resolved into a single canonical statement set? [Conflict, Spec §FR-008, Spec §Key Entities, Spec §Measurable Outcomes]

## Acceptance Criteria Quality

- [x] CHK010 Can each security-critical requirement be objectively verified from measurable acceptance criteria rather than narrative intent only? [Measurability, Spec §Functional Requirements, Spec §Measurable Outcomes]
- [x] CHK011 Are rate-limiting requirements quantified with numeric thresholds/windows per auth/admin route class? [Gap, Spec §FR-015, Spec §Security & Secrets Impact]
- [x] CHK012 Is there an explicit acceptance criterion for preventing secret leakage in logs, errors, and audit payloads? [Gap, Spec §Security & Secrets Impact, Spec §Observability & Operations]

## Scenario Coverage

- [x] CHK013 Are primary, alternate, and fallback authentication flows all covered with clear requirement statements? [Coverage, Spec §FR-001, Spec §Security & Secrets Impact]
- [x] CHK014 Are invalid, expired, revoked, and missing-credential scenarios mapped to unique structured error requirements? [Coverage, Spec §Edge Cases, Spec §FR-010]
- [x] CHK015 Are recovery requirements defined for compromised credentials (forced rotation, session invalidation, blast-radius control)? [Gap, Recovery, Spec §Security & Secrets Impact]

## Edge Case Coverage

- [x] CHK016 Are requirements defined for cross-origin preflight failures and credentialed CORS edge behavior? [Edge Case, Gap, Spec §Security & Secrets Impact]
- [x] CHK017 Are boundary rules defined for precedence conflicts between authorization failures and throttling responses? [Ambiguity, Spec §FR-001, Spec §FR-015]
- [x] CHK018 Are security requirements defined for remote workspace proxy failures to prevent credential disclosure or trust confusion? [Edge Case, Spec §FR-011, Spec §API Contract & Compatibility]

## Non-Functional Security Requirements

- [x] CHK019 Are security observability requirements defined with mandatory fields (actor, source, action, outcome, timestamp, correlation key)? [Gap, Spec §Observability & Operations]
- [x] CHK020 Are audit-log retention, access control, and tamper-resistance requirements explicitly specified? [Gap, Spec §FR-012, Spec §Observability & Operations]
- [x] CHK021 Is availability posture for auth services defined (fail-closed vs degraded mode) under dependency outages? [Assumption, Spec §Edge Cases, Spec §Assumptions]

## Dependencies & Assumptions

- [x] CHK022 Are trust assumptions about Modal secrets, remote workspaces, and proxy boundaries explicitly documented and testable? [Assumption, Spec §FR-011, Spec §Security & Secrets Impact]
- [x] CHK023 Are dependency-level security requirements for external model/token providers specified, including least-privilege expectations? [Gap, Dependency, Spec §Security & Secrets Impact]
- [x] CHK024 Are release-gate security requirements linked to rollback criteria when auth or routing changes are introduced? [Completeness, Spec §Observability & Operations]

## Notes

- Check items off as completed: `[x]`
- Add findings and evidence inline per item
- This checklist targets QA/Security release review at strict depth
